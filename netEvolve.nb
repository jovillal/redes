(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     44759,       1223]
NotebookOptionsPosition[     41561,       1164]
NotebookOutlinePosition[     41925,       1180]
CellTagsIndexPosition[     41882,       1177]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[TextData[{
 "Represent a graph as a list of it nodes, each node a list ",
 Cell[BoxData[
  FormBox[
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["m", "i"], ",", 
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["n", "j1"], ",", 
       SubscriptBox["n", "j2"], ",", 
       SubscriptBox["n", "jN"]}], "}"}], ",", 
     SubscriptBox["\[Phi]", "i"]}], "}"}], TraditionalForm]],ExpressionUUID->
  "67030fe5-8837-4380-ba64-e5fbba78098c"],
 "; with ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["m", "j"], "\[Element]", 
    SuperscriptBox["\[DoubleStruckCapitalN]", "+"]}], TraditionalForm]],
  ExpressionUUID->"3de4ad31-f601-4ca9-a4f5-7f21021ff63d"],
 " an integer (the amount of marbles at node ",
 Cell[BoxData[
  FormBox["m", TraditionalForm]],ExpressionUUID->
  "ec63fd0f-6b01-44c5-be32-1d13ee4798f2"],
 "); ",
 Cell[BoxData[
  FormBox[
   RowBox[{"{", 
    RowBox[{
     SubscriptBox["n", "j1"], ",", 
     SubscriptBox["n", "j2"], ",", 
     SubscriptBox["n", "jN"]}], "}"}], TraditionalForm]],ExpressionUUID->
  "f1fbb09a-31c6-4c11-ae40-1e30e9d278f7"],
 " the list of neighbors of node ",
 Cell[BoxData[
  FormBox["m", TraditionalForm]],ExpressionUUID->
  "8d63e834-db08-4144-8bb5-d64aef8db4c0"],
 "; and ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Phi]", "j"], TraditionalForm]],ExpressionUUID->
  "5f2ebe79-9cf8-4191-9bf1-ace10250a59b"],
 " the phase that determines if marbles are able to leave the node or not. \
When ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"Sin", "[", 
     RowBox[{
      RowBox[{"\[Omega]", " ", "t"}], "+", 
      SubscriptBox["\[Phi]", "i"]}], "]"}], "\[GreaterEqual]", " ", "0"}], 
   TraditionalForm]],ExpressionUUID->"503b63a3-0ec5-4649-a1eb-be8d879a218b"],
 " marbles can leave the node.\nGiven a network, the rules of the simulation \
are that at every tick:\n\t\[FilledSquare] Every node passes one of its \
marbles to one of its neighbors. The marble is passed if ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"Sin", "[", 
     RowBox[{
      RowBox[{"\[Omega]", " ", "t"}], "+", 
      SubscriptBox["\[Phi]", "i"]}], "]"}], "\[GreaterEqual]", " ", "0"}], 
   TraditionalForm]],ExpressionUUID->"42cdc991-c489-4c5a-9a23-22259d2ec8a5"],
 ", otherwise the marble stays. The marble goes to one of the node\
\[CloseCurlyQuote]s neighbor with equal probability. "
}], "Text",
 CellChangeTimes->{{3.760117761999456*^9, 3.760117763835394*^9}, {
  3.760117878955206*^9, 3.7601179308888617`*^9}, {3.760118579961363*^9, 
  3.760118592496213*^9}, {3.760118660439857*^9, 3.760118674546033*^9}, {
  3.7601187789490843`*^9, 3.760118791927154*^9}, {3.7601198954492292`*^9, 
  3.76011993834645*^9}, {3.760120038272235*^9, 3.7601200484161*^9}, {
  3.760120092668388*^9, 3.760120104455749*^9}, {3.760120413995317*^9, 
  3.760120506907254*^9}, {3.760120898326558*^9, 3.7601209672685213`*^9}, {
  3.760121084318288*^9, 3.7601211013985653`*^9}, {3.760121185000024*^9, 
  3.760121223127963*^9}, {3.760121456586241*^9, 3.76012156740387*^9}, {
  3.7601217029605007`*^9, 3.760121705783834*^9}, {3.7601218706632137`*^9, 
  3.7601219005952663`*^9}, {3.760448903016509*^9, 
  3.760448906053853*^9}},ExpressionUUID->"dfe9fbd6-90b6-4a8d-9fbd-\
b93ab99296d2"],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{
    StyleBox["graphToNet",
     FontWeight->"Bold"], "[", 
    StyleBox[
     RowBox[{"graph", ",", " ", "fun"}],
     FontSlant->"Italic"], "]"}], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "35fa926f-788c-4482-be9a-f6072dc3417b"],
 " takes a graph (Mathematica style) and returns a list ",
 Cell[BoxData[
  FormBox[
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["m", "1"], ",", 
       RowBox[{"{", 
        RowBox[{
         SubscriptBox["n", "11"], ",", 
         SubscriptBox["n", "12"], ",", 
         SubscriptBox["n", 
          RowBox[{"1", 
           SubscriptBox["N", "1"]}]]}], "}"}], ",", 
       SubscriptBox["\[Phi]", "1"]}], "}"}], ",", "\[Ellipsis]", ",", 
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["m", "i"], ",", 
       RowBox[{"{", 
        RowBox[{
         SubscriptBox["n", 
          RowBox[{"j", " ", "1"}]], ",", 
         SubscriptBox["n", 
          RowBox[{"j", " ", "2"}]], ",", 
         SubscriptBox["n", 
          RowBox[{"j", " ", 
           SubscriptBox["N", "j"]}]]}], "}"}], ",", 
       SubscriptBox["\[Phi]", "j"]}], "}"}], ",", "\[Ellipsis]", ",", 
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["m", "N"], ",", 
       RowBox[{"{", 
        RowBox[{
         SubscriptBox["n", 
          RowBox[{"N", " ", "1"}]], ",", 
         SubscriptBox["n", 
          RowBox[{"N", " ", "2"}]], ",", 
         SubscriptBox["n", 
          RowBox[{"N", " ", 
           SubscriptBox["N", "N"]}]]}], "}"}], ",", 
       SubscriptBox["\[Phi]", "N"]}], "}"}]}], "}"}], TraditionalForm]],
  ExpressionUUID->"a88265bc-87e3-4ded-970a-c56f29cc91e7"],
 "; with ",
 Cell[BoxData[
  FormBox["N", TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "61ec4b1b-718a-4dae-ad76-9ce6bb74a4e4"],
 " the number of nodes in the graph, ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["n", 
    RowBox[{"j", " ", "s"}]], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "3de23db5-c77f-463f-bf55-c8be05b882a4"],
 " the ",
 Cell[BoxData[
  FormBox["s", TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "03f8c4f2-1b1c-443d-af1a-436c644ef701"],
 "-th neighbour of node ",
 Cell[BoxData[
  FormBox["j", TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "aa38d334-e7f5-4114-a5b7-f7a74c44250c"],
 ", ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["m", "j"], "\[Element]", 
    RowBox[{"[", 
     RowBox[{"1", ",", "N"}], "]"}]}], TraditionalForm]],ExpressionUUID->
  "b9defc46-d96b-4381-82c5-6e37f2bf73c2"],
 " an integer, and ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Phi]", "j"], TraditionalForm]],ExpressionUUID->
  "03c54259-2461-4ee2-a6d2-a9a996952c83"],
 " determined by ",
 Cell[BoxData[
  FormBox[
   StyleBox["fun",
    FontSlant->"Italic"], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "8fd5b3e0-247b-4eae-942e-31b86ca578e4"],
 ". "
}], "Text",
 CellChangeTimes->{{3.760447107248803*^9, 3.760447218563951*^9}, {
  3.760447277865303*^9, 
  3.7604475258713293`*^9}},ExpressionUUID->"da1376ef-3dc4-48cf-8322-\
f17561cd45f7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"graphToNet", "[", 
   RowBox[{"g_Graph", ",", 
    RowBox[{"\[Phi]_:", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"RandomChoice", "[", 
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{"\[Pi]", "/", "2"}]}], "}"}], "]"}], "&"}], ")"}]}]}], 
   "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"nei", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Flatten", "[", 
          RowBox[{"Position", "[", 
           RowBox[{"#", ",", "1"}], "]"}], "]"}], "&"}], "/@", 
        RowBox[{"Normal", "[", 
         RowBox[{"AdjacencyMatrix", "[", "g", "]"}], "]"}]}]}], ",", 
      RowBox[{"n", "=", 
       RowBox[{"VertexCount", "[", "g", "]"}]}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"RandomInteger", "[", "n", "]"}], ",", "#", ",", 
        RowBox[{"\[Phi]", "[", "]"}]}], "}"}], "&"}], "/@", "nei"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.7604476745548*^9, 3.7604477095307217`*^9}, {
  3.7604477504870996`*^9, 3.760447770754714*^9}, {3.760447818206962*^9, 
  3.760447818529676*^9}, {3.760447860350553*^9, 3.760447876469585*^9}, {
  3.7604479371265497`*^9, 3.760447977863716*^9}, {3.760448075531217*^9, 
  3.760448091607615*^9}, {3.760448356399078*^9, 3.760448398606248*^9}, {
  3.7604484823918533`*^9, 3.760448514652697*^9}, {3.760448747193153*^9, 
  3.760448760181095*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"c44b604d-1df8-42e5-be45-7efd94616e00"],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{
    StyleBox["netEvolve",
     FontWeight->"Bold"], "[", 
    StyleBox[
     RowBox[{"graph", ",", " ", "\[Omega]", ",", "T"}],
     FontSlant->"Italic"], "]"}], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "ecdbd23c-6a3b-4495-a1f3-c88f2365e1e6"],
 " takes a graph (represented as previously described), with ",
 Cell[BoxData[
  FormBox["N", TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "4081c62e-5926-450c-801e-990eceb3f6db"],
 " nodes, an integer ",
 Cell[BoxData[
  FormBox["T", TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "780abadb-b601-4a8c-91c0-b4787aef8d8e"],
 ", and a real \[Omega] and implements the rule described above for ",
 Cell[BoxData[
  FormBox["T", TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "8c9d12ce-06da-4ec9-9798-12eb0017a9b0"],
 " ticks. It returns an ",
 Cell[BoxData[
  FormBox[
   RowBox[{"M", "\[Cross]", "T"}], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "75e1ab5c-ee53-447f-828b-61754caa15e5"],
 " matrix where every row has the number of marbles  of its corresponding \
node for each tick. This is, element ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["e", 
    RowBox[{"m", ",", "t"}]], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "a567856e-b3fd-41ee-9897-81d87e475fd4"],
 " is the number of marbles of node ",
 Cell[BoxData[
  FormBox["m", TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "f5fba9b9-0c20-4001-b7de-ae611b02e00d"],
 " at tick ",
 Cell[BoxData[
  FormBox["t", TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "736b9403-0846-4b68-917a-2c168fb5ea45"],
 "."
}], "Text",
 CellChangeTimes->{{3.760122220933365*^9, 3.7601222424778423`*^9}, {
  3.7601223630704412`*^9, 3.760122390940054*^9}, {3.760122451146208*^9, 
  3.7601226517920218`*^9}, {3.760187445861616*^9, 
  3.7601874701569033`*^9}},ExpressionUUID->"90471404-008a-4a87-9a11-\
2227a4cfbe2f"],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{
    StyleBox["netEvolveTrace",
     FontWeight->"Bold"], "[", 
    StyleBox[
     RowBox[{"graph", ",", " ", "\[Omega]", ",", "T"}],
     FontSlant->"Italic"], "]"}], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "b5962094-7a0b-42a2-98ff-3d3e4fd89053"],
 " does the same as netEvolve, but it returns a list ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          SubscriptBox["s", "11"], ",", "\[Ellipsis]", ",", 
          SubscriptBox["s", "N1"]}], "}"}], ",", "\[Ellipsis]", ",", 
        RowBox[{"{", 
         RowBox[{
          SubscriptBox["s", 
           RowBox[{"1", "T"}]], ",", "\[Ellipsis]", ",", 
          SubscriptBox["s", 
           RowBox[{"N", " ", "T"}]]}], "}"}]}], "}"}], "}"}], ",", "E"}], 
    "}"}], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "7918867f-68a5-42ec-8ce3-8f26351c8b67"],
 " with ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["s", 
    RowBox[{"n", " ", "t"}]], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "6b3c0050-604b-496c-8b85-5721bcf9b342"],
 " the number of the node that received the marble from node ",
 Cell[BoxData[
  FormBox["n", TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "a75ff84d-fce5-4550-a4e8-491b42d607ba"],
 " at time ",
 Cell[BoxData[
  FormBox["t", TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "dfedc6ca-eb2b-4bdd-9040-e876dcd7c98e"],
 "."
}], "Text",
 CellChangeTimes->{{3.760122220933365*^9, 3.7601222424778423`*^9}, {
  3.7601223630704412`*^9, 3.760122390940054*^9}, {3.760122451146208*^9, 
  3.7601226517920218`*^9}, {3.7601873108100767`*^9, 3.760187428725038*^9}, {
  3.760187490047587*^9, 
  3.760187614834169*^9}},ExpressionUUID->"a9db625c-f201-431c-a5fa-\
bff8fee77759"],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Omega]", "=", 
   RowBox[{"1", "/", "2"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.760195753510106*^9, 3.760195765625606*^9}, {
  3.7601958696180162`*^9, 3.760195870533347*^9}, {3.760195902552986*^9, 
  3.760195968634884*^9}},ExpressionUUID->"22044a60-023b-43f4-9c31-\
ea9bbe9aa0bc"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"DiscretePlot", "[", 
  RowBox[{
   RowBox[{"Sin", "[", 
    RowBox[{"\[Omega]", " ", "t"}], "]"}], ",", " ", 
   RowBox[{"{", 
    RowBox[{"t", ",", "0", ",", "10"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.76019576832933*^9, 3.7601957956450243`*^9}, {
  3.760195827581086*^9, 3.760195853340678*^9}, {3.760195893171241*^9, 
  3.7601958941166687`*^9}},
 CellLabel->"In[28]:=",ExpressionUUID->"46a59d6c-0725-45e8-9079-dc6f6499d1c7"],

Cell[BoxData[
 GraphicsBox[{
   {RGBColor[0.368417, 0.506779, 0.709798], PointSize[0.012833333333333334`], 
    AbsoluteThickness[1.6], {
     {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
      0.012833333333333334`], AbsoluteThickness[1.6], Opacity[0.2], 
      LineBox[{{{0., 0.}, {0., 0}}, {{7., -0.35078322768961984`}, {7., 0}}, {{
         8., -0.7568024953079282}, {8., 0}}, {{9., -0.977530117665097}, {
         9., 0}}, {{10., -0.9589242746631385}, {10., 0}}},
       VertexColors->None]}, 
     {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
      0.012833333333333334`], AbsoluteThickness[1.6], Opacity[0.2], 
      LineBox[{{{1., 0.479425538604203}, {1., 0}}, {{2., 
         0.8414709848078965}, {2., 0}}, {{3., 0.9974949866040544}, {
         3., 0}}, {{4., 0.9092974268256817}, {4., 0}}, {{5., 
         0.5984721441039565}, {5., 0}}, {{6., 0.1411200080598672}, {6., 0}}},
       VertexColors->None]}}}, 
   {RGBColor[0.368417, 0.506779, 0.709798], PointSize[0.012833333333333334`], 
    AbsoluteThickness[1.6], {}, 
    PointBox[{{0., 0.}, {1., 0.479425538604203}, {2., 0.8414709848078965}, {
     3., 0.9974949866040544}, {4., 0.9092974268256817}, {5., 
     0.5984721441039565}, {6., 0.1411200080598672}, {
     7., -0.35078322768961984`}, {8., -0.7568024953079282}, {
     9., -0.977530117665097}, {10., -0.9589242746631385}}], {}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->True,
  AxesOrigin->{0, 0},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  Method->{
   "MessagesHead" -> DiscretePlot, "AxisPadding" -> Scaled[0.02], 
    "DefaultBoundaryStyle" -> Automatic, "DefaultMeshStyle" -> 
    AbsolutePointSize[6], "DefaultPlotStyle" -> {
      Directive[
       RGBColor[0.368417, 0.506779, 0.709798], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.880722, 0.611041, 0.142051], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.560181, 0.691569, 0.194885], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.922526, 0.385626, 0.209179], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.528488, 0.470624, 0.701351], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.772079, 0.431554, 0.102387], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.363898, 0.618501, 0.782349], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[1, 0.75, 0], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.647624, 0.37816, 0.614037], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.571589, 0.586483, 0.], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.915, 0.3325, 0.2125], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.40082222609352647`, 0.5220066643438841, 0.85], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.9728288904374106, 0.621644452187053, 0.07336199581899142], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.736782672705901, 0.358, 0.5030266573755369], 
       AbsoluteThickness[1.6]], 
      Directive[
       RGBColor[0.28026441037696703`, 0.715, 0.4292089322474965], 
       AbsoluteThickness[1.6]]}, "DomainPadding" -> Scaled[0.02], 
    "PointSizeFunction" -> "SmallPointSize", "RangePadding" -> Scaled[0.05]},
  PlotRange->{{0, 10}, {-0.977530117665097, 0.9974949866040544}},
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.02], 
     Scaled[0.02]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{{3.760195837697007*^9, 3.760195942133613*^9}},
 CellLabel->"Out[28]=",ExpressionUUID->"d7817dbe-f3ca-4b97-8fb5-beab9d633c02"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.760460975613728*^9, 3.7604610042995377`*^9}, 
   3.7606330015825768`*^9},ExpressionUUID->"c006c0d9-07c4-4d34-a2c7-\
ad239ab1a182"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"netEvolve", "[", 
    RowBox[{"graph_List", ",", 
     RowBox[{"\[Omega]_Real", "?", "Positive"}], ",", "T_Integer"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"output", "=", 
        RowBox[{"graph", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ",", 
       RowBox[{"nodes", "=", 
        RowBox[{"Length", "[", "graph", "]"}]}], ",", "add", ",", "remove", 
       ",", "t", ",", "tmp"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"remove", "[", 
        RowBox[{"node", ":", 
         RowBox[{"{", 
          RowBox[{"0", ",", "neighs_", ",", "\[Phi]_"}], "}"}]}], "]"}], ":=",
        "node"}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"remove", "[", 
        RowBox[{"node", ":", 
         RowBox[{"{", 
          RowBox[{"m_", ",", "neighs_", ",", "\[Phi]_"}], "}"}]}], "]"}], ":=", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{
            RowBox[{"\[Omega]", " ", "t"}], "+", "\[Phi]"}], "]"}], "<", 
          "0"}], ",", "node", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"m", "-", "1"}], ",", "neighs", ",", "\[Phi]"}], "}"}], 
           ",", 
           RowBox[{"RandomChoice", "[", "neighs", "]"}]}], "}"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"t", "=", "0"}], ";", "\[IndentingNewLine]", 
      RowBox[{"add", "=", 
       RowBox[{"remove", "/@", "graph"}]}], " ", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
        "remove", " ", "marble", " ", "at", " ", "each", " ", "node"}], ",", 
        " ", 
        RowBox[{"note", " ", "where", " ", "it", " ", "goes"}]}], "*)"}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"tmp", "=", 
       RowBox[{"Cases", "[", 
        RowBox[{"add", ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"_List", ",", "i_"}], "}"}], "\[Rule]", "i"}]}], "]"}]}], 
      RowBox[{"(*", 
       RowBox[{"get", " ", "the", " ", "destination", " ", "nodes"}], "*)"}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"add", "=", 
       RowBox[{"add", "/.", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"node_List", ",", "i_Integer"}], "}"}], "\[Rule]", 
         "node"}]}]}], 
      RowBox[{"(*", 
       RowBox[{"clean", " ", "the", " ", "network"}], "*)"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"tmp", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"#", ",", 
           RowBox[{"Count", "[", 
            RowBox[{"tmp", ",", "#"}], "]"}]}], "}"}], "&"}], "/@", 
        RowBox[{"Union", "[", "tmp", "]"}]}]}], 
      RowBox[{"(*", 
       RowBox[{
       "count", " ", "how", " ", "many", " ", "marbles", " ", "go", " ", "to",
         " ", "each", " ", "node"}], "*)"}], ";", "\[IndentingNewLine]", 
      RowBox[{"tmp", "=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", "1"}], "}"}], "\[Rule]", 
            RowBox[{
             RowBox[{"add", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], ",", "1"}], "]"}], "]"}], 
             "+", 
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}]}], ")"}], "&"}], "/@", "%"}], 
        "tmp"}]}], 
      RowBox[{"(*", 
       RowBox[{"build", " ", "rules", " ", "to", " ", "add", " ", "marbles"}],
        "*)"}], ";", "\[IndentingNewLine]", 
      RowBox[{"AppendTo", "[", 
       RowBox[{"output", ",", 
        RowBox[{"ReplacePart", "[", 
         RowBox[{"add", ",", "tmp"}], "]"}]}], "]"}], 
      RowBox[{"(*", 
       RowBox[{"add", " ", "marbles"}], "*)"}], ";", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"t", "=", "1"}], ",", 
        RowBox[{"t", "\[LessEqual]", "T"}], ",", 
        RowBox[{"t", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Print", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"remove", "[", 
             RowBox[{"graph", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
            RowBox[{"Sin", "[", 
             RowBox[{
              RowBox[{"\[Omega]", " ", "t"}], "+", 
              RowBox[{"graph", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "3"}], "]"}], "]"}]}], "]"}]}], "}"}], 
          "]"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"add", "=", 
          RowBox[{"remove", "/@", 
           RowBox[{"graph", "[", 
            RowBox[{"[", 
             RowBox[{"-", "1"}], "]"}], "]"}]}]}], " ", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{
           "remove", " ", "marble", " ", "at", " ", "each", " ", "node"}], 
           ",", " ", 
           RowBox[{"note", " ", "where", " ", "it", " ", "goes"}]}], "*)"}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"tmp", "=", 
          RowBox[{"Cases", "[", 
           RowBox[{"add", ",", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"_List", ",", "i_"}], "}"}], "\[Rule]", "i"}]}], 
           "]"}]}], 
         RowBox[{"(*", 
          RowBox[{"get", " ", "the", " ", "destination", " ", "nodes"}], 
          "*)"}], ";", "\[IndentingNewLine]", 
         RowBox[{"add", "=", 
          RowBox[{"add", "/.", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"node_List", ",", "i_Integer"}], "}"}], "\[Rule]", 
            "node"}]}]}], 
         RowBox[{"(*", 
          RowBox[{"clean", " ", "the", " ", "network"}], "*)"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"tmp", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{"#", ",", 
              RowBox[{"Count", "[", 
               RowBox[{"tmp", ",", "#"}], "]"}]}], "}"}], "&"}], "/@", 
           RowBox[{"Union", "[", "tmp", "]"}]}]}], 
         RowBox[{"(*", 
          RowBox[{
          "count", " ", "how", " ", "many", " ", "marbles", " ", "go", " ", 
           "to", " ", "each", " ", "node"}], "*)"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"tmp", "=", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"#", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", "1"}], "}"}], 
               "\[Rule]", 
               RowBox[{
                RowBox[{"add", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", "1"}], "]"}], "]"}], 
                "+", 
                RowBox[{"#", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}]}], ")"}], "&"}], "/@", 
            "%"}], "tmp"}]}], 
         RowBox[{"(*", 
          RowBox[{
          "build", " ", "rules", " ", "to", " ", "add", " ", "marbles"}], 
          "*)"}], ";", "\[IndentingNewLine]", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"output", ",", 
           RowBox[{"ReplacePart", "[", 
            RowBox[{"add", ",", "tmp"}], "]"}]}], "]"}], 
         RowBox[{"(*", 
          RowBox[{"add", " ", "marbles"}], "*)"}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", "output"}]}],
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.7601881800003853`*^9, 3.760188304975915*^9}, {
   3.760188349719676*^9, 3.760188393780155*^9}, {3.7601884589568653`*^9, 
   3.760188522553049*^9}, {3.760188654191463*^9, 3.760188780623063*^9}, {
   3.760188904236802*^9, 3.760188945747387*^9}, {3.760196187844468*^9, 
   3.760196288820949*^9}, 3.7604624497929487`*^9, {3.760463503904766*^9, 
   3.7604636648473454`*^9}, {3.760464116781419*^9, 3.7604642898342743`*^9}, {
   3.7604644933792458`*^9, 3.760464539394474*^9}, {3.760464881103915*^9, 
   3.7604650330069427`*^9}, {3.7604664555281897`*^9, 3.760466536867774*^9}, {
   3.760466579319934*^9, 3.760466674456068*^9}, {3.760636875303289*^9, 
   3.760637015411632*^9}, {3.7606386383555603`*^9, 3.760638641672834*^9}, {
   3.760638673760391*^9, 3.760638930924288*^9}, {3.760639116785989*^9, 
   3.760639276946638*^9}},
 CellLabel->"In[30]:=",ExpressionUUID->"72749f88-ce36-447f-801c-a54657fd878f"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"gr", "=", 
  RowBox[{"RandomGraph", "[", 
   RowBox[{"{", 
    RowBox[{"10", ",", "15"}], "}"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.760637038395648*^9, 3.7606370450610723`*^9}},
 CellLabel->"In[24]:=",ExpressionUUID->"34cb5fe9-d1ae-40b4-b097-e5ff10956187"],

Cell[BoxData[
 GraphicsBox[
  NamespaceBox["NetworkGraphics",
   DynamicModuleBox[{Typeset`graph = HoldComplete[
     Graph[{1, 2, 3, 4, 5, 6, 7, 8, 9, 10}, {Null, 
       SparseArray[
       Automatic, {10, 10}, 0, {
        1, {{0, 3, 4, 5, 10, 14, 17, 20, 24, 27, 30}, {{4}, {8}, {10}, {5}, {
          7}, {1}, {5}, {8}, {9}, {10}, {2}, {4}, {6}, {7}, {5}, {8}, {9}, {
          3}, {5}, {9}, {1}, {4}, {6}, {10}, {4}, {6}, {7}, {1}, {4}, {8}}}, 
         Pattern}]}]]}, 
    TagBox[
     GraphicsGroupBox[
      GraphicsComplexBox[{{4.202588207175124, 1.0904299413687841`}, {
       1.5789084540485223`, 0.}, {0., 1.959069398155007}, {
       3.2541646865852565`, 1.356061976278083}, {2.0658619802813933`, 
       1.0368915037487243`}, {2.7511450757277007`, 1.847333459160578}, {
       1.0762576160793953`, 1.6770728081531645`}, {3.7785038637171486`, 
       1.8127810630335475`}, {2.1113875180118016`, 1.87428030240712}, {
       4.390142282014963, 1.6410294714916234`}}, {
        {Hue[0.6, 0.7, 0.5], Opacity[0.7], 
         {Arrowheads[0.], ArrowBox[{1, 4}, 0.03944255004625476]}, 
         {Arrowheads[0.], ArrowBox[{1, 8}, 0.03944255004625476]}, 
         {Arrowheads[0.], ArrowBox[{1, 10}, 0.03944255004625476]}, 
         {Arrowheads[0.], ArrowBox[{2, 5}, 0.03944255004625476]}, 
         {Arrowheads[0.], ArrowBox[{3, 7}, 0.03944255004625476]}, 
         {Arrowheads[0.], ArrowBox[{4, 5}, 0.03944255004625476]}, 
         {Arrowheads[0.], ArrowBox[{4, 8}, 0.03944255004625476]}, 
         {Arrowheads[0.], ArrowBox[{4, 9}, 0.03944255004625476]}, 
         {Arrowheads[0.], ArrowBox[{4, 10}, 0.03944255004625476]}, 
         {Arrowheads[0.], ArrowBox[{5, 6}, 0.03944255004625476]}, 
         {Arrowheads[0.], ArrowBox[{5, 7}, 0.03944255004625476]}, 
         {Arrowheads[0.], ArrowBox[{6, 8}, 0.03944255004625476]}, 
         {Arrowheads[0.], ArrowBox[{6, 9}, 0.03944255004625476]}, 
         {Arrowheads[0.], ArrowBox[{7, 9}, 0.03944255004625476]}, 
         {Arrowheads[0.], ArrowBox[{8, 10}, 0.03944255004625476]}}, 
        {Hue[0.6, 0.2, 0.8], EdgeForm[{GrayLevel[0], Opacity[0.7]}], 
         DiskBox[1, 0.03944255004625476], DiskBox[2, 0.03944255004625476], 
         DiskBox[3, 0.03944255004625476], DiskBox[4, 0.03944255004625476], 
         DiskBox[5, 0.03944255004625476], DiskBox[6, 0.03944255004625476], 
         DiskBox[7, 0.03944255004625476], DiskBox[8, 0.03944255004625476], 
         DiskBox[9, 0.03944255004625476], DiskBox[10, 0.03944255004625476]}}]],
     MouseAppearanceTag["NetworkGraphics"]],
    AllowKernelInitialization->False]],
  DefaultBaseStyle->{
   "NetworkGraphics", FrontEnd`GraphicsHighlightColor -> Hue[0.8, 1., 0.6]},
  FormatType->TraditionalForm,
  FrameTicks->None]], "Output",
 CellChangeTimes->{3.760637046955038*^9},
 CellLabel->"Out[24]=",ExpressionUUID->"4b82eee5-b1bb-4324-b98e-528d929753e1"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"test", "=", 
  RowBox[{"graphToNet", "[", "gr", "]"}]}]], "Input",
 CellChangeTimes->{{3.760632899612586*^9, 3.760632938676614*^9}, {
  3.7606330428424063`*^9, 3.760633044128214*^9}, {3.7606370524701033`*^9, 
  3.760637056090727*^9}},
 CellLabel->"In[25]:=",ExpressionUUID->"ddb8672e-d739-4cbf-b3b1-ad74b3aae22f"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"7", ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "8", ",", "10"}], "}"}], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"6", ",", 
     RowBox[{"{", "5", "}"}], ",", 
     FractionBox["\[Pi]", "2"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"10", ",", 
     RowBox[{"{", "7", "}"}], ",", 
     FractionBox["\[Pi]", "2"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "5", ",", "8", ",", "9", ",", "10"}], "}"}], ",", 
     FractionBox["\[Pi]", "2"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"8", ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "4", ",", "6", ",", "7"}], "}"}], ",", "0"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", 
     RowBox[{"{", 
      RowBox[{"5", ",", "8", ",", "9"}], "}"}], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"10", ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "5", ",", "9"}], "}"}], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"8", ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "4", ",", "6", ",", "10"}], "}"}], ",", "0"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "6", ",", "7"}], "}"}], ",", 
     FractionBox["\[Pi]", "2"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "4", ",", "8"}], "}"}], ",", "0"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.760632939259317*^9, 3.760633044774317*^9, 
  3.760637064712644*^9},
 CellLabel->"Out[25]=",ExpressionUUID->"32715380-1d24-4ed0-b07b-c28ac19f542a"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Omega]", "=", "12"}], ";", 
  RowBox[{"t", "=", "0"}], ";"}]], "Input",
 CellChangeTimes->{{3.7606330106673727`*^9, 3.760633024423538*^9}},
 CellLabel->"In[3]:=",ExpressionUUID->"8f982e0c-64fc-4765-9444-6b3c95494ed6"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"remove", "[", 
    RowBox[{"node", ":", 
     RowBox[{"{", 
      RowBox[{"0", ",", "neighs_", ",", "\[Phi]_"}], "}"}]}], "]"}], ":=", 
   "node"}], ";", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"remove", "[", 
    RowBox[{"node", ":", 
     RowBox[{"{", 
      RowBox[{"m_", ",", "neighs_", ",", "\[Phi]_"}], "}"}]}], "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Sin", "[", 
       RowBox[{
        RowBox[{"\[Omega]", " ", "t"}], "+", "\[Phi]"}], "]"}], "<", "0"}], 
     ",", "node", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"m", "-", "1"}], ",", "neighs", ",", "\[Phi]"}], "}"}], ",", 
       
       RowBox[{"RandomChoice", "[", "neighs", "]"}]}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellLabel->"In[4]:=",ExpressionUUID->"3f5d5f7f-2635-4ad3-9557-a0895de94fbe"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"remove", "/@", "test"}]], "Input",
 CellChangeTimes->{{3.760633032560763*^9, 3.7606330506483383`*^9}},
 CellLabel->"In[6]:=",ExpressionUUID->"f2e183de-a657-4ff5-b6c7-db920249e1d1"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"6", ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", "5", ",", "6", ",", "7", ",", "10"}], "}"}], ",", 
       "0"}], "}"}], ",", "7"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"8", ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "3", ",", "5", ",", "6", ",", "9", ",", "10"}], 
        "}"}], ",", "0"}], "}"}], ",", "6"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"{", "2", "}"}], ",", 
     FractionBox["\[Pi]", "2"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"{", "6", "}"}], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "2", ",", "7", ",", "9"}], "}"}], ",", "0"}], "}"}],
      ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"7", ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "2", ",", "4", ",", "7", ",", "8"}], "}"}], ",", 
       "0"}], "}"}], ",", "8"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "5", ",", "6"}], "}"}], ",", "0"}], "}"}], ",", 
     "6"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"{", "6", "}"}], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"5", ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", "5"}], "}"}], ",", 
       FractionBox["\[Pi]", "2"]}], "}"}], ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"2", ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "2"}], "}"}], ",", "0"}], "}"}], ",", "1"}], 
    "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.76063305155462*^9},
 CellLabel->"Out[6]=",ExpressionUUID->"f6fa9fc6-f4c8-448e-a15c-a42865389af4"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Cases", "[", 
  RowBox[{"%6", ",", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"_List", ",", "i_"}], "}"}], "\[Rule]", "i"}]}], "]"}]], "Input",\

 CellChangeTimes->{{3.760633094457944*^9, 3.760633139531011*^9}},
 CellLabel->"In[11]:=",ExpressionUUID->"9e0748f8-5bca-47a9-ad3a-ca179ca8f09a"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"7", ",", "6", ",", "2", ",", "8", ",", "6", ",", "2", ",", "1"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.7606331029996567`*^9, 3.760633140676798*^9}},
 CellLabel->"Out[11]=",ExpressionUUID->"df7064b7-a353-45db-94d6-2e4c2423b134"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"%6", "/.", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"node_List", ",", "i_Integer"}], "}"}], "\[Rule]", 
   "node"}]}]], "Input",
 CellChangeTimes->{{3.7606331748846693`*^9, 3.7606332025162687`*^9}},
 CellLabel->"In[12]:=",ExpressionUUID->"d822c476-faec-4e25-b81b-1e8e6b73467a"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"6", ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "5", ",", "6", ",", "7", ",", "10"}], "}"}], ",", 
     "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"8", ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "3", ",", "5", ",", "6", ",", "9", ",", "10"}], "}"}],
      ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"{", "2", "}"}], ",", 
     FractionBox["\[Pi]", "2"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"{", "6", "}"}], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "7", ",", "9"}], "}"}], ",", "0"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"7", ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "4", ",", "7", ",", "8"}], "}"}], ",", 
     "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "5", ",", "6"}], "}"}], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"{", "6", "}"}], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"5", ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "5"}], "}"}], ",", 
     FractionBox["\[Pi]", "2"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}], ",", "0"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.760633203273609*^9},
 CellLabel->"Out[12]=",ExpressionUUID->"c9cdf7f3-4e78-470a-83ca-86a394f6af20"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"#", ",", 
     RowBox[{"Count", "[", 
      RowBox[{"%11", ",", "#"}], "]"}]}], "}"}], "&"}], "/@", 
  RowBox[{"Union", "[", "%11", "]"}]}]], "Input",
 CellChangeTimes->{{3.760634550170282*^9, 3.7606345512411957`*^9}, {
  3.7606345857266817`*^9, 3.7606346847330027`*^9}},
 CellLabel->"In[19]:=",ExpressionUUID->"5767af99-1732-4687-a7d1-a3cb68c493d1"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"6", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"7", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"8", ",", "1"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.760634604999905*^9, 3.7606346854598093`*^9}},
 CellLabel->"Out[19]=",ExpressionUUID->"bd8f4fc3-1880-4b8a-a116-f12408669642"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"#", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", "1"}], "}"}], "\[Rule]", 
     RowBox[{
      RowBox[{"%12", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", "1"}], "]"}], "]"}], "+", 
      RowBox[{"#", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}]}], ")"}], "&"}], "/@", 
  "%19"}]], "Input",
 CellChangeTimes->{{3.7606339425753727`*^9, 3.760633950231509*^9}, {
  3.760634706534375*^9, 3.7606347583632517`*^9}},
 CellLabel->"In[21]:=",ExpressionUUID->"5c9deb2f-8e0f-44f1-91fd-b7bbe3c8002c"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"1", ",", "1"}], "}"}], "\[Rule]", "7"}], ",", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"2", ",", "1"}], "}"}], "\[Rule]", "10"}], ",", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"6", ",", "1"}], "}"}], "\[Rule]", "9"}], ",", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"7", ",", "1"}], "}"}], "\[Rule]", "2"}], ",", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"8", ",", "1"}], "}"}], "\[Rule]", "1"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.760633950894133*^9, {3.760634736192193*^9, 3.7606347590709867`*^9}},
 CellLabel->"Out[21]=",ExpressionUUID->"f6f0a161-b5e8-48cd-a67a-9b8901aa0f58"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ReplacePart", "[", 
  RowBox[{"%12", ",", "%21"}], "]"}]], "Input",
 CellChangeTimes->{{3.760633161468368*^9, 3.760633166587421*^9}, {
  3.7606332269165154`*^9, 3.760633301238426*^9}, {3.760633335158945*^9, 
  3.76063336923927*^9}, {3.760633961383703*^9, 3.760633963861205*^9}, {
  3.760634824995726*^9, 3.7606348261299067`*^9}},
 CellLabel->"In[22]:=",ExpressionUUID->"b77bba25-34a4-425c-8990-2a4c7ad69d87"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"7", ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "5", ",", "6", ",", "7", ",", "10"}], "}"}], ",", 
     "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"10", ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "3", ",", "5", ",", "6", ",", "9", ",", "10"}], "}"}],
      ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"{", "2", "}"}], ",", 
     FractionBox["\[Pi]", "2"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"{", "6", "}"}], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "7", ",", "9"}], "}"}], ",", "0"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"9", ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "4", ",", "7", ",", "8"}], "}"}], ",", 
     "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "5", ",", "6"}], "}"}], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     RowBox[{"{", "6", "}"}], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"5", ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "5"}], "}"}], ",", 
     FractionBox["\[Pi]", "2"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}], ",", "0"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.7606333709993763`*^9, 3.7606339645031557`*^9, 
  3.760634827658729*^9},
 CellLabel->"Out[22]=",ExpressionUUID->"41d74851-1aa4-44e8-88f3-c2db8f898bf8"]
}, Open  ]]
},
WindowSize->{1600, 845},
WindowMargins->{{0, Automatic}, {0, Automatic}},
Magnification:>1.25 Inherited,
FrontEndVersion->"11.3 for Linux x86 (64-bit) (March 6, 2018)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 3213, 79, 165, "Text",ExpressionUUID->"dfe9fbd6-90b6-4a8d-9fbd-b93ab99296d2"],
Cell[3774, 101, 3192, 101, 83, "Text",ExpressionUUID->"da1376ef-3dc4-48cf-8322-f17561cd45f7"],
Cell[6969, 204, 1583, 41, 127, "Input",ExpressionUUID->"c44b604d-1df8-42e5-be45-7efd94616e00"],
Cell[8555, 247, 2042, 56, 76, "Text",ExpressionUUID->"90471404-008a-4a87-9a11-2227a4cfbe2f"],
Cell[10600, 305, 1921, 56, 73, "Text",ExpressionUUID->"a9db625c-f201-431c-a5fa-bff8fee77759"],
Cell[12524, 363, 321, 7, 39, "Input",ExpressionUUID->"22044a60-023b-43f4-9c31-ea9bbe9aa0bc"],
Cell[CellGroupData[{
Cell[12870, 374, 462, 10, 39, "Input",ExpressionUUID->"46a59d6c-0725-45e8-9079-dc6f6499d1c7"],
Cell[13335, 386, 3767, 88, 293, "Output",ExpressionUUID->"d7817dbe-f3ca-4b97-8fb5-beab9d633c02"]
}, Open  ]],
Cell[17117, 477, 179, 3, 39, "Input",ExpressionUUID->"c006c0d9-07c4-4d34-a2c7-ad239ab1a182"],
Cell[17299, 482, 8817, 224, 856, "Input",ExpressionUUID->"72749f88-ce36-447f-801c-a54657fd878f"],
Cell[CellGroupData[{
Cell[26141, 710, 286, 6, 39, "Input",ExpressionUUID->"34cb5fe9-d1ae-40b4-b097-e5ff10956187"],
Cell[26430, 718, 2855, 49, 236, "Output",ExpressionUUID->"4b82eee5-b1bb-4324-b98e-528d929753e1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[29322, 772, 337, 6, 39, "Input",ExpressionUUID->"ddb8672e-d739-4cbf-b3b1-ad74b3aae22f"],
Cell[29662, 780, 1635, 50, 118, "Output",ExpressionUUID->"32715380-1d24-4ed0-b07b-c28ac19f542a"]
}, Open  ]],
Cell[31312, 833, 254, 5, 39, "Input",ExpressionUUID->"8f982e0c-64fc-4765-9444-6b3c95494ed6"],
Cell[31569, 840, 908, 28, 69, "Input",ExpressionUUID->"3f5d5f7f-2635-4ad3-9557-a0895de94fbe"],
Cell[CellGroupData[{
Cell[32502, 872, 204, 3, 39, "Input",ExpressionUUID->"f2e183de-a657-4ff5-b6c7-db920249e1d1"],
Cell[32709, 877, 1942, 63, 118, "Output",ExpressionUUID->"f6fa9fc6-f4c8-448e-a15c-a42865389af4"]
}, Open  ]],
Cell[CellGroupData[{
Cell[34688, 945, 315, 8, 39, "Input",ExpressionUUID->"9e0748f8-5bca-47a9-ad3a-ca179ca8f09a"],
Cell[35006, 955, 273, 5, 44, "Output",ExpressionUUID->"df7064b7-a353-45db-94d6-2e4c2423b134"]
}, Open  ]],
Cell[CellGroupData[{
Cell[35316, 965, 301, 7, 39, "Input",ExpressionUUID->"d822c476-faec-4e25-b81b-1e8e6b73467a"],
Cell[35620, 974, 1523, 47, 118, "Output",ExpressionUUID->"c9cdf7f3-4e78-470a-83ca-86a394f6af20"]
}, Open  ]],
Cell[CellGroupData[{
Cell[37180, 1026, 415, 10, 39, "Input",ExpressionUUID->"5767af99-1732-4687-a7d1-a3cb68c493d1"],
Cell[37598, 1038, 495, 14, 44, "Output",ExpressionUUID->"bd8f4fc3-1880-4b8a-a116-f12408669642"]
}, Open  ]],
Cell[CellGroupData[{
Cell[38130, 1057, 684, 20, 39, "Input",ExpressionUUID->"5c9deb2f-8e0f-44f1-91fd-b7bbe3c8002c"],
Cell[38817, 1079, 681, 20, 44, "Output",ExpressionUUID->"f6f0a161-b5e8-48cd-a67a-9b8901aa0f58"]
}, Open  ]],
Cell[CellGroupData[{
Cell[39535, 1104, 432, 7, 39, "Input",ExpressionUUID->"b77bba25-34a4-425c-8990-2a4c7ad69d87"],
Cell[39970, 1113, 1575, 48, 118, "Output",ExpressionUUID->"41d74851-1aa4-44e8-88f3-c2db8f898bf8"]
}, Open  ]]
}
]
*)

